<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–µ—à–∞ –∏ –ö–µ–∫—Å —Å–Ω–∏–º–∞—é—Ç —Å—Ç—Ä–µ—Å—Å!</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–π (6 —Å–µ–∫—É–Ω–¥) */
            --celebration-duration: 6s;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            padding: 0;
            margin: 0;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }

        /* --- –ù–û–í–´–ï –ë–õ–û–ö–ò –î–õ–Ø –í–ï–†–•–ê –°–¢–†–ê–ù–ò–¶–´ --- */
        .top-fixed-elements {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            /* –£—á–∏—Ç—ã–≤–∞–µ–º Telegram header */
            padding-top: calc(env(safe-area-inset-top, 20px) + 5px); 
            z-index: 1000;
        }

        /* –ö–Ω–æ–ø–∫–∏ Telegram-–∑–∞–≥–ª—É—à–∫–∏ –£–î–ê–õ–ï–ù–´ */
        .telegram-buttons {
            /* –ë–ª–æ–∫ —É–¥–∞–ª–µ–Ω */
        }

        /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π, –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≥—Ä–∏–¥ –∞—á–∏–≤–æ–∫ */
        .achievement-grid {
            display: flex;
            justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å–ª–æ—Ç—ã */
            gap: 5px;
            padding: 5px 10px;
            max-width: 95%;
            margin: 0 auto;
        }

        /* –°–ª–æ—Ç –∞—á–∏–≤–∫–∏ —Å–¥–µ–ª–∞–Ω –º–µ–Ω—å—à–µ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
        .achievement-slot {
            height: 30px; /* –£–º–µ–Ω—å—à–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
            width: 50px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, –º–∞–ª–µ–Ω—å–∫–∞—è —à–∏—Ä–∏–Ω–∞ */
            min-width: 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px; /* –°–∫—Ä—É–≥–ª–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ */
            display: flex;
            align-items: center;
            justify-content: center;
            color: #b0b0b0;
            font-size: 10px;
            font-weight: 500;
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
        }

        .achievement-slot.unlocked {
            background: linear-gradient(45deg, #4CAF50 0%, #8BC34A 100%);
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
            transform: scale(1.05);
        }

        /* --- –°–î–í–ò–ì –ö–û–ù–¢–ï–ù–¢–ê –í–ù–ò–ó --- */
        .content-wrapper {
            /* –£—á–∏—Ç—ã–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –±–ª–æ–∫–∞ top-fixed-elements –∏ —Å–¥–≤–∏–≥–∞–µ–º –≤–Ω–∏–∑ */
            padding-top: calc(env(safe-area-inset-top, 100px) + 70px); 
            padding-bottom: env(safe-area-inset-bottom, 20px);
            max-width: 90%;
            margin: 0 auto;
        }

        /* --- –ù–û–í–ê–Ø –ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê (TAP ZONE) --- */
        .tap-zone {
            display: block;
            width: 100vw;
            /* –í—ã—Å–æ—Ç–∞ –Ω–∞ –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é –æ–±–ª–∞—Å—Ç—å –Ω–∏–∂–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background: transparent; /* –û–°–¢–ê–í–õ–ï–ù–û –ü–†–û–ó–†–ê–ß–ù–´–ú */
            border: none;
            cursor: pointer;
            z-index: 10;
            margin: 0;
            padding: 0;
        }

        /* --- –ü–û–ó–ò–¶–ò–û–ù–ò–†–û–í–ê–ù–ò–ï –í–°–ï–ì–û –ö–û–ù–¢–ï–ù–¢–ê --- */
        .main-content {
             position: relative;
             z-index: 20; /* –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–¥ –∫–Ω–æ–ø–∫–æ–π */
        }
        
        .cat-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            gap: 20px;
            position: relative;
            z-index: 20; 
        }

        .cat {
            width: 150px;
            height: 150px;
            cursor: pointer;
            border-radius: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.1);
            touch-action: manipulation;
        }

        h1 {
            color: #ffffff;
            font-size: 22px;
            font-weight: 600;
            margin: 0 0 10px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* --- –í–°–ü–õ–´–í–ê–Æ–©–ï–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –ü–ï–†–ï–ù–ï–°–ï–ù–û –í–í–ï–†–• --- */
        .achievement {
            position: fixed;
            top: 10%; /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —Å–≤–µ—Ä—Ö—É */
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            color: #ffffff;
            padding: 15px 25px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            z-index: 2000; /* –í—ã—à–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
            opacity: 0;
            transition: opacity 0.3s;
            display: none;
            pointer-events: none;
        }

        /* --- –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –°–¢–ò–õ–¨ –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê --- */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            display: flex; /* –í–∞–∂–Ω–æ: display: none –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ JS */
            justify-content: center;
            align-items: center;
            z-index: 5000; /* –°–ê–ú–´–ô –í–´–°–û–ö–ò–ô –°–õ–û–ô */
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none; /* –°–Ω–∞—á–∞–ª–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ */
        }
        .modal.show {
            opacity: 1;
            pointer-events: all; /* –î–µ–ª–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–∏ –ø–æ–∫–∞–∑–µ */
        }
        .modal-content {
            background: linear-gradient(135deg, rgba(10,10,10,0.95) 0%, rgba(26,26,46,0.95) 50%, rgba(22,33,62,0.95) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            color: #ffffff;
            font-family: 'SF Pro Display', sans-serif;
            font-size: 18px;
            font-weight: 500;
            max-width: 80%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        }
        /* –ü—Ä–æ—á–∏–µ —Å—Ç–∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–π –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        @keyframes flash-strong {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.2; }
        }
        @keyframes blink-strong {
            0%, 100% { background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%); }
            50% { background: linear-gradient(135deg, #FFD700 0%, #FF69B4 50%, #00FFFF 100%); }
        }
        /* ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ @keyframes) */
    </style>
</head>
<body>
    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <p>–ü—Ä–∏–≤–µ—Ç, –ù–∏–∫—á—ë–º–Ω–∏, –≤–∫—É—Å–Ω–∏ –ø—Ä–∏–Ω—ë—Å–±?! üòª</p>
            <button class="close-btn" onclick="closeModal()">–ù–∞—á–∞—Ç—å —Ç–µ—Ä–∞–ø–∏—é!</button>
        </div>
    </div>

    <div class="top-fixed-elements">
        <div class="achievement-grid" id="achievementGrid">
            <div id="ach-slot-100" class="achievement-slot" title="100 —Ç–∞–ø–æ–≤">100 üêæ</div>
            <div id="ach-slot-200" class="achievement-slot" title="200 —Ç–∞–ø–æ–≤">200 ‚ú®</div>
            <div id="ach-slot-500" class="achievement-slot" title="500 —Ç–∞–ø–æ–≤">500 üåü</div>
            <div id="ach-slot-1000" class="achievement-slot" title="1K —Ç–∞–ø–æ–≤">1K üòª</div>
            <div id="ach-slot-2000" class="achievement-slot" title="2K —Ç–∞–ø–æ–≤">2K üíñ</div>
            <div id="ach-slot-5000" class="achievement-slot" title="5K —Ç–∞–ø–æ–≤">5K üéâ</div>
            <div id="ach-slot-10000" class="achievement-slot" title="10K —Ç–∞–ø–æ–≤">10K üèÜ</div>
        </div>
    </div>

    <div class="content-wrapper">
        <div class="main-content">
            <h1>–ö–µ—à–∞ –∏ –ö–µ–∫—Å —Å–Ω–∏–º–∞—é—Ç —Å—Ç—Ä–µ—Å—Å!‚ù§Ô∏è</h1>
            <div class="cat-container" id="catContainer">
                <img id="cat1" class="cat cat1" src="https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2550.jpeg" alt="–ö–µ—à–∞ (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π –∫–æ—Ç–∏–∫)">
                <img id="cat2" class="cat cat2" src="https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2558.jpeg" alt="–ö–µ–∫—Å (—Å–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π –∫–æ—Ç–∏–∫)">
            </div>
            <div id="score">–û—á–∫–∏ —É—é—Ç–∞: 0</div>
            <button onclick="showLeaderboard()">üèÜ –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ø</button>
            <p>–ö–æ—Ç–∏–∫–∏ –º—É—Ä–ª—ã—á—É—Ç –≤ —É–Ω–∏—Å–æ–Ω! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≥–ª–∞–¥–∏—Ç—å –∫–æ—Ç–∏–∫–æ–≤! üòª</p>
        </div>
    </div>

    <button id="tapZone" class="tap-zone" aria-label="–ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è —Ç–∞–ø–æ–≤"></button>

    <div id="achievement" class="achievement">
        <span id="ach-text"></span> üèÜ
    </div>
    
    <audio id="backgroundMusic" loop autoplay>
        <source src="mur.mp3" type="audio/mpeg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
    </audio>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        let score = 0;
        let cat1Index = 0;
        let cat2Index = 0;
        const CELEBRATION_DURATION_MS = 6000;

        // –ú–∞—Å—Å–∏–≤—ã —Å —Ñ–æ—Ç–æ (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const cat1Photos = [
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2550.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2556.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2546.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2548.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2557.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_9_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_6_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_4_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_3_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_3_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_2_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_2_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_23_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_22_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_1_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_17_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_16_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_14_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_11_2025-11-10_16-54-08.jpg"
        ];
        const cat2Photos = [
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2558.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2552.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2549.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2555.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2547.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Rerks_6_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_8_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_7_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_5_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_5_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_4_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_24_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_21_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_1_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_19_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_18_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_15_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_13_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_12_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_10_2025-11-10_16-54-08.jpg"
        ];

        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞–º–∏ –¥–ª—è –∞—á–∏–≤–æ–∫ ---
        const achievementThresholds = [1, 50];
        for (let i = 1; i <= 10000000; i++) {
            achievementThresholds.push(i * 100);
            achievementThresholds.push(i * 100 + 50);
        }
        
        const everyHundredThresholds = [];
        for (let i = 1; i <= 10000000; i++) {
            everyHundredThresholds.push(i * 100);
        }

        const milestoneThresholds = [];
        for (let k = 0; k <= 999999; k++) {
            const thresh = 500 + (k * 1000);
            if (thresh <= 1000000000) {
                milestoneThresholds.push(thresh);
            }
        }

        const superThresholds = [];
        for (let i = 1; i <= 1000000; i++) {
            superThresholds.push(i * 1000);
        }

        const unlockedAchievements = new Set();
        const unlockedMilestones = new Set();
        const unlockedSupers = new Set();
        
        // –ú–∞–ø–ø–∏–Ω–≥ –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ—Ç–æ–≤ –≤–≤–µ—Ä—Ö—É
        const achSlotMapping = { 
            100: 'ach-slot-100', 
            200: 'ach-slot-200', 
            500: 'ach-slot-500', 
            1000: 'ach-slot-1000', 
            2000: 'ach-slot-2000', 
            5000: 'ach-slot-5000',
            10000: 'ach-slot-10000'
        }; 

        // --- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã) ---

        function createParticle(x, y, emoji = '‚ô•Ô∏è', color = '#ff69b4', container = document.body, duration = 1000, isCelebration = false) {
            const particle = document.createElement('div');
            particle.innerHTML = emoji;
            particle.className = 'heart';
            if (isCelebration) {
                particle.classList.add('celebration-particle');
            }

            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.color = color;
            particle.style.fontSize = (24 + Math.random() * 12) + 'px';
            particle.style.pointerEvents = 'none';
            particle.style.zIndex = '100';

            const randX = (Math.random() - 0.5) * (isCelebration ? 400 : 80);
            particle.style.setProperty('--rand-x', randX + 'px');

            const finalDuration = isCelebration ? duration : 1000;
            particle.style.animation = `floatUp ${finalDuration / 1000}s ease-out forwards`;

            container.appendChild(particle);

            setTimeout(() => {
                particle.remove();
            }, finalDuration);
        }

        function launchSalute() {
            const numHearts = 50;
            for (let i = 0; i < numHearts; i++) {
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                setTimeout(() => createParticle(x, y, '‚ô•Ô∏è', '#ff69b4', document.body, CELEBRATION_DURATION_MS, true), i * 50);
            }
            if (tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('heavy');
            }
        }

        // MILESTONE: –ò–∑–º–µ–Ω–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –Ω–∞ –±–æ–ª–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–µ –º–∏–≥–∞–Ω–∏–µ
        function launchMilestone() {
            if (unlockedMilestones.has(score)) return;
            unlockedMilestones.add(score);
            
            if (tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('heavy');
                setTimeout(() => tg.HapticFeedback.impactOccurred('medium'), 200);
            }

            // 1. –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –Ω–∞ 6 —Å–µ–∫—É–Ω–¥, –º–∏–≥–∞—é—â–∞—è —Å–∏–ª—å–Ω–µ–µ
            document.body.style.animation = `blink-strong 0.5s ease-in-out infinite`; 
            
            // 2. –í–∑—Ä—ã–≤ –ª–∞–ø–æ–∫ –∏ –∑–≤—ë–∑–¥–æ—á–µ–∫
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const numParticles = 30;
            const emojis = ['üêæ', '‚≠ê', '‚ú®', 'üê±'];
            const colors = ['#ffd700', '#00ff00', '#ff00ff', '#ffff00'];
            for (let i = 0; i < numParticles; i++) {
                const emoji = emojis[Math.floor(Math.random() * emojis.length)];
                const color = colors[Math.floor(Math.random() * colors.length)];
                const delay = i * 30;
                setTimeout(() => {
                    const angle = (i / numParticles) * Math.PI * 2 + Math.random() * Math.PI/4;
                    const dist = 200 + Math.random() * 200;
                    const x = centerX + Math.cos(angle) * dist;
                    const y = centerY + Math.sin(angle) * dist;
                    createParticle(x, y, emoji, color, document.body, CELEBRATION_DURATION_MS, true);
                }, delay);
            }
            
            // 3. –û—Ç–º–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ 6 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                document.body.style.animation = '';
            }, CELEBRATION_DURATION_MS);
        }

        // SUPER: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è, –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è flash-strong
        function launchSuperEffect(threshold) {
            if (unlockedSupers.has(threshold)) return;
            unlockedSupers.add(threshold);

            // 1. –ú–∞—Å—Å–æ–≤—ã–π —à—Ç–æ—Ä–º —ç–º–æ–¥–∑–∏ –ø–æ –≤—Å–µ–º—É —ç–∫—Ä–∞–Ω—É
            const numParticles = 100;
            const superEmojis = ['üòª', 'üéâ', '‚ú®', '‚≠ê', 'üêæ', 'üíñ', 'üåü', 'üéä'];
            const superColors = ['#ff69b4', '#ffd700', '#00ff00', '#ff00ff', '#ffff00', '#ff1493', '#00bfff', '#ff4500'];
            for (let i = 0; i < numParticles; i++) {
                const emoji = superEmojis[Math.floor(Math.random() * superEmojis.length)];
                const color = superColors[Math.floor(Math.random() * superColors.length)];
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                const delay = i * 20;
                setTimeout(() => createParticle(x, y, emoji, color, document.body, CELEBRATION_DURATION_MS, true), delay);
            }

            // 2. –°–∏–ª—å–Ω–æ–µ –º–∏–≥–∞–Ω–∏–µ –∫–æ—Ç–æ–≤ (6 —Å–µ–∫—É–Ω–¥)
            const cats = document.querySelectorAll('.cat');
            cats.forEach(cat => {
                cat.style.animation = 'flash-strong 0.3s ease-in-out infinite';
                setTimeout(() => cat.style.animation = '', CELEBRATION_DURATION_MS);
            });
            
            // 3. –†–∞–¥—É–∂–Ω—ã–π —Ñ–ª–µ—à —Ñ–æ–Ω–∞ —Å –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ (6 —Å–µ–∫—É–Ω–¥)
            const originalBg = document.body.style.background;
            const flashes = [
                'linear-gradient(135deg, #ff69b4 0%, #ff1493 50%, #c71585 100%)',
                'linear-gradient(135deg, #ffd700 0%, #ffff00 50%, #ff4500 100%)',
                'linear-gradient(135deg, #00ff00 0%, #00bfff 50%, #0000ff 100%)',
                'linear-gradient(135deg, #ff00ff 0%, #8a2be2 50%, #4b0082 100%)'
            ];
            let flashIndex = 0;
            const flashInterval = setInterval(() => {
                document.body.style.background = flashes[flashIndex % flashes.length];
                flashIndex++;
            }, 200);
            setTimeout(() => {
                clearInterval(flashInterval);
                document.body.style.background = originalBg;
            }, CELEBRATION_DURATION_MS);

            // 4. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è (6 —Å–µ–∫—É–Ω–¥)
            if (tg.HapticFeedback) {
                for (let v = 0; v < CELEBRATION_DURATION_MS / 300; v++) {
                    setTimeout(() => tg.HapticFeedback.impactOccurred('heavy'), v * 300);
                }
            }

            // 5. –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–°–ö–û–†–†–ï–ö–¢–ò–†–û–í–ê–ù–û)
            const achText = document.getElementById('ach-text');
            achText.innerText = `${threshold} —Ç–∞–ø–æ–≤! üåàüí•`;
            const elem = document.getElementById('achievement');
            elem.classList.add('show');
            setTimeout(() => {
                elem.classList.remove('show');
            }, CELEBRATION_DURATION_MS - 2000);
        }

        // Achievement: –£–±—Ä–∞–Ω–æ —Å–ª–æ–≤–æ "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:"
        function showAchievement(threshold) {
            if (unlockedAchievements.has(threshold)) return;
            unlockedAchievements.add(threshold);
            
            if (tg.HapticFeedback) {
                tg.HapticFeedback.notificationOccurred('success');
            }

            const achText = document.getElementById('ach-text');
            achText.innerText = `${threshold} —Ç–∞–ø–æ–≤! üéâ`;
            const elem = document.getElementById('achievement');
            elem.classList.add('show');
            setTimeout(() => {
                elem.classList.remove('show');
            }, 3000);
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–æ—Ç–∞ –≤ –≥—Ä–∏–¥–µ
            if (achSlotMapping[threshold]) {
                const slotId = achSlotMapping[threshold];
                const slot = document.getElementById(slotId);
                if (slot) {
                    slot.classList.add('unlocked');
                    slot.onclick = () => alert(`–ê—á–∏–≤–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞: ${threshold} —Ç–∞–ø–æ–≤!`);
                }
            }
        }

        function checkAchievement(newScore) {
            // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ –±–ª–∏–∂–∞–π—à–µ–π —Å–æ—Ç–Ω–∏/—Ç—ã—Å—è—á–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            const checkScore = newScore % 100 === 0 ? newScore : (newScore % 50 === 0 ? newScore : newScore);
            
            // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –°–£–ü–ï–† (–∫–∞–∂–¥–∞—è 1000)
            if (superThresholds.includes(checkScore)) {
                launchSuperEffect(checkScore);
            }
            // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ MILESTONE (500, 1500, 2500...)
            else if (milestoneThresholds.includes(checkScore)) {
                launchMilestone();
            }
            // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ SALUTE (–ö–∞–∂–¥–∞—è —Å–æ—Ç–Ω—è, –∏—Å–∫–ª—é—á–∞—è MILESTONE –∏ SUPER)
            else if (everyHundredThresholds.includes(checkScore)) {
                const isMilestone = milestoneThresholds.includes(checkScore);
                const isSuper = superThresholds.includes(checkScore);

                if (!isMilestone && !isSuper) {
                    launchSalute();
                }
            }

            // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–±—ã—á–Ω—É—é –ê—á–∏–≤–∫—É (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
            if (achievementThresholds.includes(checkScore)) {
                showAchievement(checkScore);
            }
        }

        function clickCat(catNumber, x, y) {
            score++;
            document.getElementById('score').innerText = `–û—á–∫–∏ —É—é—Ç–∞: ${score}`;
            checkAchievement(score);

            // –ü–æ–ª—É—á–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–ª–∏–∫–∞
            let finalX, finalY;
            const cat = document.getElementById('cat' + catNumber);
            const rect = cat.getBoundingClientRect();
            
            // –ï—Å–ª–∏ –ø—Ä–∏—à–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–∞–ø–∞ —Å –±–æ–ª—å—à–æ–π –∫–Ω–æ–ø–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
            if (x !== undefined && y !== undefined) {
                 finalX = x;
                 finalY = y;
            } 
            // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –ø—Ä—è–º–æ –ø–æ –∫–æ—Ç—É, –±–µ—Ä–µ–º –µ–≥–æ —Ü–µ–Ω—Ç—Ä
            else { 
                finalX = rect.left + rect.width / 2;
                finalY = rect.top + rect.height / 2;
            }

            // –°–æ–∑–¥–∞—ë–º —Å–µ—Ä–¥–µ—á–∫–æ
            createParticle(finalX, finalY, '‚ô•Ô∏è', '#ff69b4');

            // –ú–µ–Ω—è–µ–º —Ñ–æ—Ç–æ 
            if (catNumber === 1) {
                cat1Index = (cat1Index + 1) % cat1Photos.length;
                document.getElementById('cat1').src = cat1Photos[cat1Index];
            } else if (catNumber === 2) {
                cat2Index = (cat2Index + 1) % cat2Photos.length;
                document.getElementById('cat2').src = cat2Photos[cat2Index];
            }

            // –ê–≤—Ç–æ—Å–µ–π–≤ —Å—á—ë—Ç–∞
            tg.GameProxy.setGameScore({ score: score }, (data) => {
                if (data) {
                    // Score saved
                }
            });
        }

        function showLeaderboard() {
            tg.GameProxy.showLeaderboard();
        }

        // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ö–†–´–¢–ò–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê
        function closeModal() {
            const modal = document.getElementById('welcomeModal');
            modal.classList.remove('show');
            // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏
            // –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É, –µ—Å–ª–∏ –æ–Ω–∞ –±—ã–ª–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞.
            const audio = document.getElementById('backgroundMusic');
            audio.play().catch(e => console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–≤—É–∫'));
        }
        
        // –õ–û–ì–ò–ö–ê –î–õ–Ø –ë–û–õ–¨–®–û–ô –ö–ù–û–ü–ö–ò
        function handleTapZone(e) {
            e.preventDefault();

            let clientX;
            let clientY;
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            if (e.touches && e.touches.length > 0) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else if (e.clientX !== undefined) {
                clientX = e.clientX;
                clientY = e.clientY;
            } else {
                return;
            }

            const button = e.currentTarget;
            const rect = button.getBoundingClientRect();
            const center = rect.left + rect.width / 2;
            
            let catToClick;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–æ—Ä–æ–Ω—É —Ç–∞–ø–∞
            if (clientX < center) {
                catToClick = 1; // –®–æ–∫–æ–ª–∞–¥–Ω—ã–π –∫–æ—Ç–∏–∫ (–ö–µ—à–∞)
            } else {
                catToClick = 2; // –°–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π –∫–æ—Ç–∏–∫ (–ö–µ–∫—Å)
            }
            
            // –í—ã–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫–ª–∏–∫–∞, –ø–µ—Ä–µ–¥–∞–≤–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–∞–ø–∞
            clickCat(catToClick, clientX, clientY);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.onload = function() {
            // –ü–û–ö–ê–ó–´–í–ê–ï–ú –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
            const modal = document.getElementById('welcomeModal');
            modal.classList.add('show');

            // –ú—É–∑—ã–∫–∞ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É –≤ –º–æ–¥–∞–ª–∫–µ (–≤ closeModal)
            const audio = document.getElementById('backgroundMusic');
            audio.volume = 0.3;

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–ª–∏–∫–æ–≤/—Ç–∞–ø–æ–≤
            const tapZone = document.getElementById('tapZone');
            tapZone.addEventListener('touchstart', handleTapZone, { passive: false });
            tapZone.addEventListener('click', handleTapZone);
            
            // –¢–∞–∫–∂–µ –æ—Å—Ç–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ —Å–∞–º–∏—Ö –∫–æ—Ç–∞—Ö –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ —Ç–∞–ø–∞/–∫–ª–∏–∫–∞
            const cat1 = document.getElementById('cat1');
            const cat2 = document.getElementById('cat2');
            cat1.addEventListener('touchstart', (e) => { e.preventDefault(); clickCat(1, e.touches[0].clientX, e.touches[0].clientY); }, { passive: false });
            cat2.addEventListener('touchstart', (e) => { e.preventDefault(); clickCat(2, e.touches[0].clientX, e.touches[0].clientY); }, { passive: false });
            cat1.addEventListener('click', (e) => clickCat(1, e.clientX, e.clientY));
            cat2.addEventListener('click', (e) => clickCat(2, e.clientX, e.clientY));
        };
    </script>
    <div id="footer" style="position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); font-size: 12px; color: #b0b0b0; white-space: nowrap; z-index: 1;">Kesha and Keks (v0.3) powerd by Jeremy Elfo (c) 2025</div>
</body>
</html>
