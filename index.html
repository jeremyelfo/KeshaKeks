<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>–ö–µ—à–∞ –∏ –ö–µ–∫—Å —Å–Ω–∏–º–∞—é—Ç —Å—Ç—Ä–µ—Å—Å!</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            --celebration-duration: 6s;
        }
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            padding: 0;
            margin: 0;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }

        /* –í–µ—Ä—Ö–Ω–∏–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —É—á–µ—Ç–æ–º safe area Telegram */
        .top-fixed-elements {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding-top: env(safe-area-inset-top, 20px);
            background: transparent;
            z-index: 1000;
            user-select: none;
        }

        /* –í–µ—Ä—Ö–Ω–∏–π —Ä—è–¥ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∞—á–∏–≤–æ–∫ */
        .achievement-small-row {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 5px 10px 0 10px;
            max-width: 100%;
            overflow-x: auto;
            margin-bottom: 4px;
        }
        /* –ú–∞–ª–µ–Ω—å–∫–∏–µ –∞—á–∏–≤–∫–∏-–º–∞—Ä–∫–µ—Ä—ã —Ü–µ–ª—å */
        .achievement-small {
            flex: 0 0 auto;
            width: 50px;
            height: 28px;
            background: rgba(255, 255, 255, 0.07);
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #999;
            font-weight: 600;
            cursor: default;
            user-select: none;
            white-space: nowrap;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .achievement-small.unlocked {
            background: linear-gradient(45deg, #ff69b4, #ff1493);
            color: white;
            border-color: #ff1493;
            box-shadow: 0 0 8px #ff1493;
        }

        /* –ù–∏–∂–Ω–∏–π —Ä—è–¥ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞—á–∏–≤–æ–∫ (3 –∫–æ–ª–æ–Ω–∫–∏) */
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            padding: 0 10px 10px 10px;
            max-width: 360px;
            margin: 0 auto 8px auto;
        }
        .achievement-slot {
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #b0b0b0;
            font-size: 10px;
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
            user-select: none;
        }
        .achievement-slot.unlocked {
            background: linear-gradient(45deg, #4CAF50 0%, #8BC34A 100%);
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        #welcomeModal {
            position: fixed;
            top: env(safe-area-inset-top, 20px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20,20,30,0.95);
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.7);
            max-width: 320px;
            width: 90vw;
            z-index: 3000;
            padding: 20px;
            color: #eee;
            font-size: 18px;
            font-weight: 600;
            user-select: none;
            display: none;
        }
        #welcomeModal.show {
            display: block;
        }
        #welcomeModal p {
            margin: 0 0 15px 0;
        }
        #welcomeModal .close-btn {
            background: #ff69b4;
            border: none;
            border-radius: 12px;
            padding: 10px 25px;
            color: white;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            box-shadow: 0 4px 12px rgba(255, 105, 180, 0.6);
            transition: background-color 0.3s ease;
        }
        #welcomeModal .close-btn:hover {
            background: #ff1493;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∏–∂–µ –≤–µ—Ä—Ö–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .content-wrapper {
            padding-top: calc(env(safe-area-inset-top, 20px) + 90px);
            padding-bottom: env(safe-area-inset-bottom, 20px);
            max-width: 90%;
            margin: 0 auto;
            user-select: none;
        }

        /* –ö–æ—Ç–∏–∫–∏ */
        .cat-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            gap: 20px;
            position: relative;
            z-index: 20; /* –ù–∞–¥ tap-zone */
        }
        .cat {
            width: 150px;
            height: 150px;
            cursor: pointer;
            border-radius: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.1);
            touch-action: manipulation;
        }
        .cat:active {
            transform: scale(0.98);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ç–µ–∫—Å—Ç */
        h1 {
            color: #ffffff;
            font-size: 22px;
            font-weight: 600;
            margin: 0 0 10px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        p {
            color: #b0b0b0;
            font-size: 14px;
            margin-top: 5px;
            margin-bottom: 5px;
        }

        /* –ë–æ–ª—å—à–∞—è –∫—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞ —Å–Ω–∏–∑—É */
        #tapZone {
            display: block;
            position: fixed;
            bottom: env(safe-area-inset-bottom, 20px);
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at center, #ff69b4 40%, #ff1493 95%);
            border-radius: 50%;
            border: 3px solid #ff1493;
            box-shadow: 0 0 15px #ff1493;
            cursor: pointer;
            z-index: 10;
            touch-action: manipulation;
            transition: box-shadow 0.3s ease;
        }
        #tapZone:active {
            box-shadow: 0 0 25px #ff1493 inset;
        }
        #tapZone[aria-label] {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            font-weight: 700;
            user-select: none;
        }

        /* –ê—á–∏–≤–∫–∞-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ */
        #achievement {
            position: fixed;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            color: #ffffff;
            padding: 15px 25px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s;
            display: none;
            pointer-events: none;
        }
        #achievement.show {
            opacity: 1;
            display: block;
            animation: bounceUp 0.5s ease;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) translateX(0) rotate(0deg) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-120px) translateX(var(--rand-x, 0px)) rotate(360deg) scale(0.5);
            }
        }
        @keyframes bounceUp {
            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(10px); }
            60% { transform: translateX(-50%) translateY(5px); }
        }
        @keyframes flash-strong {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.2; }
        }
        @keyframes blink-strong {
            0%, 100% { background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%); }
            50% { background: linear-gradient(135deg, #FFD700 0%, #FF69B4 50%, #00FFFF 100%); }
        }

        .heart {
            position: absolute;
            font-size: 24px;
            color: #ff69b4;
            pointer-events: none;
            z-index: 100;
            animation: floatUp 1s ease-out forwards;
            transform-origin: center;
        }
        .celebration-particle {
            animation-duration: var(--celebration-duration);
        }

        #footer {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #b0b0b0;
            white-space: nowrap;
            z-index: 1;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="top-fixed-elements" aria-label="–ê—á–∏–≤–∫–∏ –∏ —Ü–µ–ª–∏">
        <div class="achievement-small-row" id="smallAchievements">
            <!-- –ú–∞–ª–µ–Ω—å–∫–∏–µ –∞—á–∏–≤–∫–∏ (—Ü–µ–ª–µ–≤—ã–µ) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–∑ –Ω–∞–±–æ—Ä–∞ -->
        </div>
        <div class="achievement-grid" id="achievementGrid">
            <div id="ach-slot-1" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')">100 üêæ</div>
            <div id="ach-slot-2" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')">200 ‚ú®</div>
            <div id="ach-slot-3" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')">500 üåü</div>
            <div id="ach-slot-4" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')">1K üòª</div>
            <div id="ach-slot-5" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')">2K üíñ</div>
            <div id="ach-slot-6" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')">5K üéâ</div>
        </div>
    </div>

    <div id="welcomeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="welcomeTitle">
        <p id="welcomeTitle">–ü—Ä–∏–≤–µ—Ç, –ù–∏–∫—á—ë–º–Ω–∏, –≤–∫—É—Å–Ω–∏ –ø—Ä–∏–Ω—ë—Å–±?! üòª</p>
        <button class="close-btn" onclick="closeModal()">–ù–∞—á–∞—Ç—å —Ç–µ—Ä–∞–ø–∏—é!</button>
    </div>

    <div class="content-wrapper" role="main">
        <h1>–ö–µ—à–∞ –∏ –ö–µ–∫—Å —Å–Ω–∏–º–∞—é—Ç —Å—Ç—Ä–µ—Å—Å!‚ù§Ô∏è</h1>
        <div class="cat-container" id="catContainer">
            <img id="cat1" class="cat cat1" src="https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2550.jpeg" alt="–ö–µ—à–∞ (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π –∫–æ—Ç–∏–∫)" />
            <img id="cat2" class="cat cat2" src="https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2558.jpeg" alt="–ö–µ–∫—Å (—Å–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π –∫–æ—Ç–∏–∫)" />
        </div>
        <div id="score">–û—á–∫–∏ —É—é—Ç–∞: 0</div>
        <p>–ö–æ—Ç–∏–∫–∏ –º—É—Ä–ª—ã—á—É—Ç –≤ —É–Ω–∏—Å–æ–Ω! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≥–ª–∞–¥–∏—Ç—å –∫–æ—Ç–∏–∫–æ–≤! üòª</p>
    </div>

    <button id="tapZone" class="tap-zone" aria-label="–ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è —Ç–∞–ø–æ–≤"></button>

    <div id="achievement" class="achievement" role="alert" aria-live="assertive">
        <span id="ach-text"></span> üèÜ
    </div>

    <audio id="backgroundMusic" loop autoplay>
        <source src="mur.mp3" type="audio/mpeg" />
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
    </audio>

    <div id="footer">Kesha and Keks (v0.3) powered by Jeremy Elfo (c) 2025</div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        let score = 0;
        let cat1Index = 0;
        let cat2Index = 0;
        const CELEBRATION_DURATION_MS = 6000;

        // –ú–∞—Å—Å–∏–≤—ã —Å —Ñ–æ—Ç–æ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã)
        const cat1Photos = [
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2550.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2556.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2546.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2548.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2557.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_9_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_6_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_4_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_3_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_3_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_2_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_2_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_23_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_22_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_1_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_17_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_16_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_14_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_11_2025-11-10_16-54-08.jpg"
        ];

        const cat2Photos = [
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2558.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2552.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2549.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2555.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2547.jpeg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Rerks_6_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_8_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_7_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_5_2025-11-10_17-01-48.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_5_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_4_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_24_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_21_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_1_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_19_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_18_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_15_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_13_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_12_2025-11-10_16-54-08.jpg",
            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_10_2025-11-10_16-54-08.jpg"
        ];

        const achievementThresholds = [100, 200, 500, 1000, 2000, 5000];
        const smallGoals = [50, 150, 300, 700, 1500, 3000];

        const unlockedAchievements = new Set();

        // –°–æ–∑–¥–∞–µ–º –º–∞–ª—ã–µ —Ü–µ–ª–µ–≤—ã–µ –∞—á–∏–≤–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤ –º–∞–ª–µ–Ω—å–∫–∏–π —Ä—è–¥
        function renderSmallAchievements() {
            const container = document.getElementById('smallAchievements');
            container.innerHTML = '';
            smallGoals.forEach(thresh => {
                const div = document.createElement('div');
                div.classList.add('achievement-small');
                if (unlockedAchievements.has(thresh)) div.classList.add('unlocked');
                div.innerText = `${thresh} —Ç–∞–ø–æ–≤`;
                div.title = unlockedAchievements.has(thresh) ? `–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ ${thresh} —Ç–∞–ø–æ–≤` : `–¶–µ–ª—å: ${thresh} —Ç–∞–ø–æ–≤`;
                container.appendChild(div);
            });
        }

        function createParticle(x, y, emoji = '‚ô•Ô∏è', color = '#ff69b4', container = document.body, duration = 1000, isCelebration = false) {
            const particle = document.createElement('div');
            particle.innerHTML = emoji;
            particle.className = 'heart';
            if (isCelebration) {
                particle.classList.add('celebration-particle');
            }
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.color = color;
            particle.style.fontSize = (24 + Math.random() * 12) + 'px';
            particle.style.pointerEvents = 'none';
            particle.style.zIndex = '100';
            const randX = (Math.random() - 0.5) * (isCelebration ? 400 : 80);
            particle.style.setProperty('--rand-x', randX + 'px');
            const finalDuration = isCelebration ? duration : 1000;
            particle.style.animation = `floatUp ${finalDuration / 1000}s ease-out forwards`;
            container.appendChild(particle);
            setTimeout(() => {
                particle.remove();
            }, finalDuration);
        }

        // –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–∫ –ø–æ –∫–æ—Ç—É
        function clickCat(catNumber, x, y) {
            score++;
            document.getElementById('score').innerText = `–û—á–∫–∏ —É—é—Ç–∞: ${score}`;
            checkAchievement(score);

            let finalX, finalY;
            if (catNumber === 1 || catNumber === 2) {
                const cat = document.getElementById('cat' + catNumber);
                const rect = cat.getBoundingClientRect();
                finalX = rect.left + rect.width / 2;
                finalY = rect.top + rect.height / 2;
            } else {
                finalX = x;
                finalY = y;
            }
            createParticle(finalX, finalY, '‚ô•Ô∏è', '#ff69b4');

            if (catNumber === 1) {
                cat1Index = (cat1Index + 1) % cat1Photos.length;
                document.getElementById('cat1').src = cat1Photos[cat1Index];
            } else if (catNumber === 2) {
                cat2Index = (cat2Index + 1) % cat2Photos.length;
                document.getElementById('cat2').src = cat2Photos[cat2Index];
            }

            tg.GameProxy.setGameScore({ score: score }, (data) => {
                // Score saved
            });
        }

        function showAchievement(threshold) {
            if (tg.HapticFeedback) {
                tg.HapticFeedback.notificationOccurred('success');
            }
            unlockedAchievements.add(threshold);
            renderSmallAchievements();

            const achText = document.getElementById('ach-text');
            achText.innerText = `${threshold} —Ç–∞–ø–æ–≤! üéâ`;
            const elem = document.getElementById('achievement');
            elem.classList.add('show');
            setTimeout(() => {
                elem.classList.remove('show');
            }, 3000);

            // –û–±–Ω–æ–≤–ª—è–µ–º —è—á–µ–π–∫—É –≤ –≥—Ä–∏–¥–µ
            const achSlotMapping = { 100: 1, 200: 2, 500: 3, 1000: 4, 2000: 5, 5000: 6 };
            if (achSlotMapping[threshold]) {
                const slot = document.getElementById(`ach-slot-${achSlotMapping[threshold]}`);
                if (slot) {
                    slot.classList.add('unlocked');
                    slot.onclick = () => alert(`–ê—á–∏–≤–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞: ${threshold} —Ç–∞–ø–æ–≤!`);
                }
            }
        }

        function checkAchievement(newScore) {
            if (achievementThresholds.includes(newScore) && !unlockedAchievements.has(newScore)) {
                showAchievement(newScore);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –±–æ–ª—å—à–æ–π –∫–Ω–æ–ø–∫–∏
        function handleTapZone(e) {
            e.preventDefault();
            let clientX;
            if (e.touches && e.touches.length > 0) {
                clientX = e.touches[0].clientX;
            } else if (e.clientX !== undefined) {
                clientX = e.clientX;
            } else {
                return;
            }
            const rect = e.currentTarget.getBoundingClientRect();
            const center = rect.left + rect.width / 2;
            const tapX = clientX;
            const tapY = rect.top + rect.height / 2;

            let catToClick = tapX < center ? 1 : 2;
            clickCat(catToClick, tapX, tapY);
        }

        function closeModal() {
            document.getElementById('welcomeModal').classList.remove('show');
        }

        window.onload = function() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
            const modal = document.getElementById('welcomeModal');
            modal.classList.add('show');

            const audio = document.getElementById('backgroundMusic');
            audio.volume = 0.3;
            audio.play().catch(e => console.log('–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∑–≤—É–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'));
            
            const cat1 = document.getElementById('cat1');
            const cat2 = document.getElementById('cat2');
            cat1.addEventListener('touchstart', (e) => { e.preventDefault(); clickCat(1); }, { passive: false });
            cat2.addEventListener('touchstart', (e) => { e.preventDefault(); clickCat(2); }, { passive: false });
            cat1.addEventListener('click', () => clickCat(1));
            cat2.addEventListener('click', () => clickCat(2));

            const tapZone = document.getElementById('tapZone');
            tapZone.addEventListener('touchstart', handleTapZone, { passive: false });
            tapZone.addEventListener('click', handleTapZone);

            renderSmallAchievements();
        };
    </script>
</body>
</html>
