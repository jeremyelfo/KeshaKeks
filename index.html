<!DOCTYPE html>

<html lang="ru">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>–ö–µ—à–∞ –∏ –ö–µ–∫—Å —Å–Ω–∏–º–∞—é—Ç —Å—Ç—Ä–µ—Å—Å!</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body.has-modal {
            overflow: hidden;
        }



        .modal {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(12px);
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            z-index: 5000;
        }



        .modal.show {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }



        .modal-content {
            width: 100%;
            max-width: 320px;
            padding: 28px 24px 24px;
            border-radius: 20px;
            background: rgba(16, 16, 32, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.5);
            color: #ffffff;
            text-align: center;
        }



        .modal-content p {
            margin: 0 0 20px;
            font-size: 16px;
            line-height: 1.4;
        }

        .modal-content h2 {
            margin: 0 0 20px 0;
            font-size: 20px;
            font-weight: 700;
            color: #ffffff;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        #leaderboardList {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
            text-align: left;
            max-height: 300px;
            overflow-y: auto;
        }

        #leaderboardList li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
            font-size: 15px;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        #leaderboardList li:last-child {
            border-bottom: none;
        }



        .primary-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 44px;
            padding: 0 24px;
            border-radius: 14px;
            border: none;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: 0.3px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(22, 33, 62, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }



        .primary-btn--full {

            width: 100%;

        }



        .primary-btn:active {
            transform: scale(0.96) translateY(1px);
            background: linear-gradient(135deg, #0f0f1a 0%, #0d1525 50%, #0a1d3a 100%);
            box-shadow: 0 2px 6px rgba(22, 33, 62, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }
        
        .primary-btn:hover {
            box-shadow: 0 6px 16px rgba(22, 33, 62, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        :root {

            /* –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–π (6 —Å–µ–∫—É–Ω–¥) */

            --celebration-duration: 6s;

        }



        body {

            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;

            text-align: center;

            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);

            color: #e0e0e0;

            padding: 0;

            margin: 0;

            min-height: 100vh;

            position: relative;

            overflow: hidden;

            touch-action: manipulation;

        }



        /* --- –ù–û–í–´–ï –ë–õ–û–ö–ò –î–õ–Ø –í–ï–†–•–ê –°–¢–†–ê–ù–ò–¶–´ --- */

        .achievements-bar {
            position: fixed;
            top: calc(env(safe-area-inset-top, 20px) + 90px);
            left: 0;
            right: 0;
            padding-top: 8px;
            padding-bottom: 8px;
            z-index: 1000;
            display: flex;
            justify-content: center;
            pointer-events: none;
        }



        .achievement-grid {
            flex: none;
            display: grid;
            grid-template-columns: repeat(6, minmax(0, 1fr));
            gap: 4px;
            padding: 0 12px;
            max-width: 100%;
            width: 100%;
            pointer-events: auto;
        }



        .achievement-slot {
            min-height: 24px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f1f1f1;
            font-size: 9px;
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
            gap: 3px;
            padding: 0 4px;
            white-space: nowrap;
        }
        



        .achievement-slot span:first-child {
            font-size: 11px;
        }



        .achievement-slot span:last-child {

            font-weight: 600;

            letter-spacing: 0.5px;

        }





        .achievement-slot.unlocked {
            background: linear-gradient(135deg, rgba(22, 33, 62, 0.8) 0%, rgba(15, 52, 96, 0.9) 100%);
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(22, 33, 62, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.2);
        }



        /* --- –°–î–í–ò–ì –ö–û–ù–¢–ï–ù–¢–ê –í–ù–ò–ó --- */

        .content-wrapper {
            /* –û–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∏–∂–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –∞—á–∏–≤–æ–∫ (2 —Ä—è–¥–∞) */
            padding-top: calc(env(safe-area-inset-top, 20px) + 200px);
            padding-bottom: env(safe-area-inset-bottom, 20px);
            max-width: 90%;
            margin: 0 auto;
        }



        /* --- –ù–û–í–ê–Ø –ë–û–õ–¨–®–ê–Ø –ö–ù–û–ü–ö–ê (TAP ZONE) --- */

        .tap-zone {

            display: block;

            width: 100vw; /* –®–∏—Ä–∏–Ω–∞ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */

            height: 40vh; /* –í—ã—Å–æ—Ç–∞ –Ω–∞ 40% –æ—Ç –≤—ã—Å–æ—Ç—ã –≤–∏–¥–∏–º–æ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞ */

            position: fixed;

            bottom: 0;

            left: 0;

            /* –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –Ω–∞ –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é –æ–±–ª–∞—Å—Ç—å */

            min-height: calc(50vh - 100px); 

            background: transparent;

            border: none;

            cursor: pointer;

            z-index: 10;

            margin: 0;

            padding: 0;

        }



        /* --- –°–¢–ò–õ–ò –û–°–¢–ê–õ–ò–°–¨ –í –û–°–ù–û–í–ù–û–ú –¢–ï –ñ–ï, –ù–û –ù–ï–ú–ù–û–ì–û –û–ß–ò–©–ï–ù–´ --- */



        .cat-container {

            display: flex;

            justify-content: space-around;

            margin: 20px 0;

            gap: 20px;

            position: relative;

            z-index: 20; /* –ö–æ—Ç–∏–∫–∏ –Ω–∞–¥ —Ç–∞—á-–∑–æ–Ω–æ–π */

        }



        .cat {

            width: 150px;

            height: 150px;

            cursor: pointer;

            border-radius: 20px;

            transition: transform 0.2s ease, box-shadow 0.2s ease;

            box-shadow: 0 4px 20px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);

            border: 1px solid rgba(255,255,255,0.1);

            touch-action: manipulation;

        }



        .cat:active {

            transform: scale(0.98);

        }



        h1 {
            color: #ffffff;
            font-size: 24px;
            font-weight: 700;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: -0.5px;
            margin: 0 0 10px 0;
            text-shadow: 0 2px 8px rgba(0,0,0,0.6), 0 0 20px rgba(255,255,255,0.1);
        }



        p {
            color: #d0d0d0;
            font-size: 15px;
            font-weight: 400;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: 0.2px;
            line-height: 1.5;
            margin-top: 5px;
            margin-bottom: 5px;
        }

        #score {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: 0.3px;
            margin: 15px 0;
            text-shadow: 0 2px 6px rgba(0,0,0,0.5);
        }



        /* –ê—á–∏–≤–∫–∞-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–æ—Å—Ç–∞–≤–ª–µ–Ω–∞, –Ω–æ —Å –Ω–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º) */

        .achievement {
            position: fixed;
            top: calc(env(safe-area-inset-top, 20px) + 45px);
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            color: #ffffff;
            padding: 10px 18px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.12);
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            display: none;
            pointer-events: none;
        }

        .achievement.show {
            opacity: 1;
            display: block;
            animation: bounceUp 0.5s ease;
            transform: translateX(-50%) translateY(0);
        }





        /* –ê–Ω–∏–º–∞—Ü–∏—è –º–∏–≥–∞–Ω–∏—è –¥–ª—è —Å—É–ø–µ—Ä-—ç—Ñ—Ñ–µ–∫—Ç–∞ */

        /* –£–í–ï–õ–ò–ß–ï–ù–û –ö–û–õ–ò–ß–ï–°–¢–í–û –ú–ò–ì–ê–ù–ò–ô */

        @keyframes flash-strong {

            0%, 100% { opacity: 1; }

            50% { opacity: 0.2; }

        }



        /* –£–í–ï–õ–ò–ß–ï–ù–ê –ö–û–ù–¢–†–ê–°–¢–ù–û–°–¢–¨ –¶–í–ï–¢–û–í –ú–ò–ì–ê–ù–ò–Ø */

        @keyframes blink-strong {

            0%, 100% { background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%); }

            50% { background: linear-gradient(135deg, #FFD700 0%, #FF69B4 50%, #00FFFF 100%); }

        }

        

        /* –ü—Ä–æ—á–∏–µ —Å—Ç–∏–ª–∏... */

        .heart {

            position: absolute;

            font-size: 24px;

            color: #ff69b4;

            pointer-events: none;

            z-index: 100;

            animation: floatUp 1s ease-out forwards;

            transform-origin: center;

        }

        .celebration-particle {

             animation-duration: var(--celebration-duration);

        }

        @keyframes floatUp {

            0% {

                opacity: 1;

                transform: translateY(0) translateX(0) rotate(0deg) scale(1);

            }

            100% {

                opacity: 0;

                transform: translateY(-120px) translateX(var(--rand-x, 0px)) rotate(360deg) scale(0.5);

            }

        }

        @keyframes bounceUp {

            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }

            40% { transform: translateX(-50%) translateY(10px); }

            60% { transform: translateX(-50%) translateY(5px); }

        }

    </style>

</head>

<body>

    <div class="achievements-bar">

        <div class="achievement-grid" id="achievementGrid">

            <!-- –ü–µ—Ä–≤—ã–π —Ä—è–¥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
            <div id="ach-slot-100" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üêæ</span><span>100</span></div>
            <div id="ach-slot-200" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>‚ú®</span><span>200</span></div>
            <div id="ach-slot-500" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üåü</span><span>500</span></div>
            <div id="ach-slot-1k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üòª</span><span>1K</span></div>
            <div id="ach-slot-2k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üíñ</span><span>2K</span></div>
            <div id="ach-slot-5k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üéâ</span><span>5K</span></div>

            <!-- –í—Ç–æ—Ä–æ–π —Ä—è–¥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
            <div id="ach-slot-10k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üéØ</span><span>10K</span></div>
            <div id="ach-slot-20k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>‚≠ê</span><span>20K</span></div>
            <div id="ach-slot-50k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üíé</span><span>50K</span></div>
            <div id="ach-slot-100k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üëë</span><span>100K</span></div>
            <div id="ach-slot-500k" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üèÜ</span><span>500K</span></div>
            <div id="ach-slot-1m" class="achievement-slot" onclick="alert('–ï—â—ë –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!')"><span>üåü</span><span>1M</span></div>

        </div>

    </div>



    <div id="welcomeModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">

        <div class="modal-content">

            <p>–ü—Ä–∏–≤–µ—Ç, –ù–∏–∫—á—ë–º–Ω–∏, –≤–∫—É—Å–Ω–∏ –ø—Ä–∏–Ω—ë—Å–±?! üòª</p>

            <button class="primary-btn primary-btn--full" onclick="closeModal()">–ù–∞—á–∞—Ç—å —Ç–µ—Ä–∞–ø–∏—é!</button>

        </div>

    </div>



    <div id="leaderboardModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">

        <div class="modal-content">

            <h2>üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</h2>

            <ul id="leaderboardList"></ul>

            <button class="primary-btn primary-btn--full" onclick="document.getElementById('leaderboardModal').classList.remove('show'); document.body.classList.remove('has-modal');">–ó–∞–∫—Ä—ã—Ç—å</button>

        </div>

    </div>



    <div class="content-wrapper">

        <h1>–ö–µ—à–∞ –∏ –ö–µ–∫—Å —Å–Ω–∏–º–∞—é—Ç —Å—Ç—Ä–µ—Å—Å!‚ù§Ô∏è</h1>

        <div class="cat-container" id="catContainer">

            <img id="cat1" class="cat cat1" src="https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2550.jpeg" alt="–ö–µ—à–∞ (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π –∫–æ—Ç–∏–∫)">

            <img id="cat2" class="cat cat2" src="https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2558.jpeg" alt="–ö–µ–∫—Å (—Å–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π –∫–æ—Ç–∏–∫)">

        </div>

        <div id="score">–û—á–∫–∏ —É—é—Ç–∞: 0</div>

        <button class="primary-btn" onclick="showLeaderboard()">üèÜ –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ø</button>

        <p>–ö–æ—Ç–∏–∫–∏ –º—É—Ä–ª—ã—á—É—Ç –≤ —É–Ω–∏—Å–æ–Ω! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≥–ª–∞–¥–∏—Ç—å –∫–æ—Ç–∏–∫–æ–≤! üòª</p>

    </div>



    <button id="tapZone" class="tap-zone" aria-label="–ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è —Ç–∞–ø–æ–≤"></button>



    <div id="achievement" class="achievement">

        <span id="ach-text"></span> üèÜ

    </div>



    <audio id="backgroundMusic" loop autoplay>

        <source src="mur.mp3" type="audio/mpeg">

        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.

    </audio>



    <script>

        const tg = window.Telegram.WebApp;

        tg.ready();

        tg.expand();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
        let supabaseClient = null;
        try {
            const supabaseUrl = 'https://aduxktmwnrilsbpydhye.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkdXhrdG13bnJpbHNicHlkaHllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3ODc2MzYsImV4cCI6MjA3ODM2MzYzNn0.MBj-HLDcqu2PHkbJp7ZfvWf2GsX_83-ZFny3YI5uRbU';
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Supabase SDK
            if (typeof window.supabase !== 'undefined' && window.supabase.createClient) {
                supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);
            } else {
                console.warn('Supabase SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –ª–∏–¥–µ—Ä–±–æ—Ä–¥ –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Supabase:', error);
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å Supabase
        async function updateScore(telegramId, username, newScore) {
            if (!supabaseClient) {
                return; // Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
            }

            try {
                const { data, error } = await supabaseClient
                    .from('leaderboard')
                    .select('max_score')
                    .eq('telegram_id', telegramId)
                    .single();

                if (error && error.code !== 'PGRST116') {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ max_score:', error);
                    return;
                }

                const currentMax = data ? data.max_score : 0;

                if (newScore > currentMax) {
                    const { error: upsertError } = await supabaseClient
                        .from('leaderboard')
                        .upsert({ telegram_id: telegramId, username: username, max_score: newScore, updated_at: new Date().toISOString() }, { onConflict: 'telegram_id' });

                    if (upsertError) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—á–µ—Ç–∞:', upsertError);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤ updateScore:', error);
            }
        }

        async function getLeaderboardTop() {
            if (!supabaseClient) {
                console.warn('Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return [];
            }

            try {
                const { data, error } = await supabaseClient
                    .from('leaderboard')
                    .select('username, max_score')
                    .order('max_score', { ascending: false })
                    .limit(10);

                if (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–æ–ø–∞:', error);
                    return [];
                }
                return data || [];
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤ getLeaderboardTop:', error);
                return [];
            }
        }

        async function showLeaderboard() {
            try {
                const leaderboardModal = document.getElementById('leaderboardModal');
                const leaderboardList = document.getElementById('leaderboardList');
                
                if (!leaderboardModal || !leaderboardList) {
                    console.error('–≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                    return;
                }

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                leaderboardList.innerHTML = '<li style="color: #b0b0b0;">–ó–∞–≥—Ä—É–∑–∫–∞...</li>';
                leaderboardModal.classList.add('show');
                leaderboardModal.setAttribute('aria-hidden', 'false');
                document.body.classList.add('has-modal');

                const leaderboardData = await getLeaderboardTop();
                leaderboardList.innerHTML = '';

                if (leaderboardData.length === 0) {
                    const li = document.createElement('li');
                    li.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∫–æ—Ä–¥–æ–≤';
                    li.style.color = '#b0b0b0';
                    leaderboardList.appendChild(li);
                } else {
                    leaderboardData.forEach(({ username, max_score }, index) => {
                        const li = document.createElement('li');
                        li.textContent = `${index + 1}. ${username || '–ê–Ω–æ–Ω–∏–º'} - ${max_score} –æ—á–∫–æ–≤`;
                        leaderboardList.appendChild(li);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:', error);
                const leaderboardList = document.getElementById('leaderboardList');
                if (leaderboardList) {
                    leaderboardList.innerHTML = '<li style="color: #ff6b6b;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>';
                }
            }
        }

        let score = 0;

        let cat1Index = 0;

        let cat2Index = 0;

        const CELEBRATION_DURATION_MS = 6000;



        // –ú–∞—Å—Å–∏–≤—ã —Å —Ñ–æ—Ç–æ (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

        const cat1Photos = [

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2550.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2556.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2546.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2548.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2557.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_9_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_6_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_4_2025-11-10_17-01-48.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_3_2025-11-10_17-01-48.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_3_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_2_2025-11-10_17-01-48.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_2_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_23_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_22_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_1_2025-11-10_17-01-48.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_17_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_16_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_14_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/photo_11_2025-11-10_16-54-08.jpg"

        ];

        const cat2Photos = [

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2558.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2552.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2549.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2555.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/IMG_2547.jpeg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Rerks_6_2025-11-10_17-01-48.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_8_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_7_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_5_2025-11-10_17-01-48.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_5_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_4_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_24_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_21_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_1_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_19_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_18_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_15_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_13_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_12_2025-11-10_16-54-08.jpg",

            "https://raw.githubusercontent.com/jeremyelfo/KeshaKeks/refs/heads/main/Keks_10_2025-11-10_16-54-08.jpg"

        ];



        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞–º–∏ –¥–ª—è –∞—á–∏–≤–æ–∫ –∏ –ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–π (–°–ö–û–†–†–ï–ö–¢–ò–†–û–í–ê–ù–û) ---



        const achievementThresholds = [1, 50];

        for (let i = 1; i <= 10000000; i++) {

            achievementThresholds.push(i * 100);

            achievementThresholds.push(i * 100 + 50);

        }

        

        // –ú–∞–º–º–∏/–ü–∞–ø–ø–∏ (–£–î–ê–õ–ï–ù–û)

        const specialThresholds = []; 



        const everyHundredThresholds = [];

        for (let i = 1; i <= 10000000; i++) {

            everyHundredThresholds.push(i * 100);

        }



        const milestoneThresholds = [];

        for (let k = 0; k <= 999999; k++) {

            const thresh = 500 + (k * 1000);

            if (thresh <= 1000000000) {

                milestoneThresholds.push(thresh);

            }

        }



        const superThresholds = [];

        for (let i = 1; i <= 1000000; i++) {

            superThresholds.push(i * 1000);

        }



        const unlockedAchievements = new Set();

        const unlockedMilestones = new Set();

        const unlockedSupers = new Set();

        const achSlotMapping = { 
            100: '100',
            200: '200',
            500: '500',
            1000: '1k',
            2000: '2k',
            5000: '5k',
            10000: '10k', 
            20000: '20k', 
            50000: '50k', 
            100000: '100k', 
            500000: '500k', 
            1000000: '1m' 
        }; // –î–ª—è –≥—Ä–∏–¥–∞



        // --- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ---



        function createParticle(x, y, emoji = '‚ô•Ô∏è', color = '#ff69b4', container = document.body, duration = 1000, isCelebration = false) {

            const particle = document.createElement('div');

            particle.innerHTML = emoji;

            particle.className = 'heart';

            if (isCelebration) {

                particle.classList.add('celebration-particle');

            }



            particle.style.left = x + 'px';

            particle.style.top = y + 'px';

            particle.style.color = color;

            particle.style.fontSize = (24 + Math.random() * 12) + 'px';

            particle.style.pointerEvents = 'none';

            particle.style.zIndex = '100';



            const randX = (Math.random() - 0.5) * (isCelebration ? 400 : 80);

            particle.style.setProperty('--rand-x', randX + 'px');



            const finalDuration = isCelebration ? duration : 1000;

            particle.style.animation = `floatUp ${finalDuration / 1000}s ease-out forwards`;



            container.appendChild(particle);



            setTimeout(() => {

                particle.remove();

            }, finalDuration);

        }



        function launchSalute() {

            const numHearts = 50;

            for (let i = 0; i < numHearts; i++) {

                const x = Math.random() * window.innerWidth;

                const y = Math.random() * window.innerHeight;

                setTimeout(() => createParticle(x, y, '‚ô•Ô∏è', '#ff69b4', document.body, CELEBRATION_DURATION_MS, true), i * 50);

            }

            if (tg.HapticFeedback) {

                tg.HapticFeedback.impactOccurred('heavy');

            }

        }



        // MILESTONE: –ò–∑–º–µ–Ω–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –Ω–∞ –±–æ–ª–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–µ –º–∏–≥–∞–Ω–∏–µ

        function launchMilestone() {

            if (tg.HapticFeedback) {

                tg.HapticFeedback.impactOccurred('heavy');

                setTimeout(() => tg.HapticFeedback.impactOccurred('medium'), 200);

            }



            // 1. –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –Ω–∞ 6 —Å–µ–∫—É–Ω–¥, –º–∏–≥–∞—é—â–∞—è —Å–∏–ª—å–Ω–µ–µ

            document.body.style.animation = `blink-strong 0.5s ease-in-out infinite`; 

            

            // 2. –í–∑—Ä—ã–≤ –ª–∞–ø–æ–∫ –∏ –∑–≤—ë–∑–¥–æ—á–µ–∫

            const centerX = window.innerWidth / 2;

            const centerY = window.innerHeight / 2;

            const numParticles = 30;

            const emojis = ['üêæ', '‚≠ê', '‚ú®', 'üê±'];

            const colors = ['#ffd700', '#00ff00', '#ff00ff', '#ffff00'];

            for (let i = 0; i < numParticles; i++) {

                const emoji = emojis[Math.floor(Math.random() * emojis.length)];

                const color = colors[Math.floor(Math.random() * colors.length)];

                const delay = i * 30;

                setTimeout(() => {

                    const angle = (i / numParticles) * Math.PI * 2 + Math.random() * Math.PI/4;

                    const dist = 200 + Math.random() * 200;

                    const x = centerX + Math.cos(angle) * dist;

                    const y = centerY + Math.sin(angle) * dist;

                    createParticle(x, y, emoji, color, document.body, CELEBRATION_DURATION_MS, true);

                }, delay);

            }

            

            // 3. –û—Ç–º–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ 6 —Å–µ–∫—É–Ω–¥

            setTimeout(() => {

                document.body.style.animation = '';

            }, CELEBRATION_DURATION_MS);

        }



        // SUPER: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è, –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è flash-strong

        function launchSuperEffect(threshold) {

            if (unlockedSupers.has(threshold)) return;

            unlockedSupers.add(threshold);



            // 1. –ú–∞—Å—Å–æ–≤—ã–π —à—Ç–æ—Ä–º —ç–º–æ–¥–∑–∏ –ø–æ –≤—Å–µ–º—É —ç–∫—Ä–∞–Ω—É

            const numParticles = 100;

            const superEmojis = ['üòª', 'üéâ', '‚ú®', '‚≠ê', 'üêæ', 'üíñ', 'üåü', 'üéä'];

            const superColors = ['#ff69b4', '#ffd700', '#00ff00', '#ff00ff', '#ffff00', '#ff1493', '#00bfff', '#ff4500'];

            for (let i = 0; i < numParticles; i++) {

                const emoji = superEmojis[Math.floor(Math.random() * superEmojis.length)];

                const color = superColors[Math.floor(Math.random() * superColors.length)];

                const x = Math.random() * window.innerWidth;

                const y = Math.random() * window.innerHeight;

                const delay = i * 20;

                setTimeout(() => createParticle(x, y, emoji, color, document.body, CELEBRATION_DURATION_MS, true), delay);

            }



            // 2. –°–∏–ª—å–Ω–æ–µ –º–∏–≥–∞–Ω–∏–µ –∫–æ—Ç–æ–≤ (6 —Å–µ–∫—É–Ω–¥)

            const cats = document.querySelectorAll('.cat');

            cats.forEach(cat => {

                cat.style.animation = 'flash-strong 0.3s ease-in-out infinite'; // –ë–æ–ª–µ–µ —á–∞—Å—Ç–æ–µ –º–∏–≥–∞–Ω–∏–µ

                setTimeout(() => cat.style.animation = '', CELEBRATION_DURATION_MS);

            });

            

            // 3. –†–∞–¥—É–∂–Ω—ã–π —Ñ–ª–µ—à —Ñ–æ–Ω–∞ —Å –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ (6 —Å–µ–∫—É–Ω–¥)

            const originalBg = document.body.style.background;

            const flashes = [

                'linear-gradient(135deg, #ff69b4 0%, #ff1493 50%, #c71585 100%)',

                'linear-gradient(135deg, #ffd700 0%, #ffff00 50%, #ff4500 100%)',

                'linear-gradient(135deg, #00ff00 0%, #00bfff 50%, #0000ff 100%)',

                'linear-gradient(135deg, #ff00ff 0%, #8a2be2 50%, #4b0082 100%)'

            ];

            let flashIndex = 0;

            const flashInterval = setInterval(() => {

                document.body.style.background = flashes[flashIndex % flashes.length];

                flashIndex++;

            }, 200);

            setTimeout(() => {

                clearInterval(flashInterval);

                document.body.style.background = originalBg;

            }, CELEBRATION_DURATION_MS);



            // 4. –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è (6 —Å–µ–∫—É–Ω–¥)

            if (tg.HapticFeedback) {

                for (let v = 0; v < CELEBRATION_DURATION_MS / 300; v++) {

                    setTimeout(() => tg.HapticFeedback.impactOccurred('heavy'), v * 300);

                }

            }



            // 5. –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–°–ö–û–†–†–ï–ö–¢–ò–†–û–í–ê–ù–û)

            const achText = document.getElementById('ach-text');

            achText.innerText = `${threshold} —Ç–∞–ø–æ–≤! üåàüí•`; // –£–±—Ä–∞–Ω–æ —Å–ª–æ–≤–æ "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:"

            const elem = document.getElementById('achievement');

            elem.classList.add('show');

            setTimeout(() => {

                elem.classList.remove('show');

            }, CELEBRATION_DURATION_MS - 2000);

        }



        // Achievement: –£–±—Ä–∞–Ω–æ —Å–ª–æ–≤–æ "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:"

        function showAchievement(threshold) {

            if (tg.HapticFeedback) {

                tg.HapticFeedback.notificationOccurred('success');

            }



            const achText = document.getElementById('ach-text');

            achText.innerText = `${threshold} —Ç–∞–ø–æ–≤! üéâ`; // –£–±—Ä–∞–Ω–æ —Å–ª–æ–≤–æ "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:"

            const elem = document.getElementById('achievement');

            elem.classList.add('show');

            setTimeout(() => {

                elem.classList.remove('show');

            }, 3000);

            

            // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–æ—Ç–∞ –≤ –≥—Ä–∏–¥–µ

            if (achSlotMapping[threshold]) {

                const slotId = `ach-slot-${achSlotMapping[threshold]}`;

                const slot = document.getElementById(slotId);

                if (slot) {

                    slot.classList.add('unlocked');

                    slot.onclick = () => alert(`–ê—á–∏–≤–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞: ${threshold} —Ç–∞–ø–æ–≤!`);

                }

            }

        }

        

        // showSpecialAchievement - –£–î–ê–õ–ï–ù–û



        function checkAchievement(newScore) {

            // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –°–£–ü–ï–† (–∫–∞–∂–¥–∞—è 1000)

            if (superThresholds.includes(newScore) && !unlockedSupers.has(newScore)) {

                launchSuperEffect(newScore);

            }

            // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ MILESTONE (500, 1500, 2500...)

            else if (milestoneThresholds.includes(newScore) && !unlockedMilestones.has(newScore)) {

                unlockedMilestones.add(newScore);

                launchMilestone();

            }

            // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ SALUTE (–ö–∞–∂–¥–∞—è —Å–æ—Ç–Ω—è, –∏—Å–∫–ª—é—á–∞—è MILESTONE –∏ SUPER)

            else if (everyHundredThresholds.includes(newScore)) {

                const isMilestone = milestoneThresholds.includes(newScore);

                const isSuper = superThresholds.includes(newScore);



                if (!isMilestone && !isSuper) {

                    launchSalute();

                }

            }



            // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–±—ã—á–Ω—É—é –ê—á–∏–≤–∫—É (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

            if (achievementThresholds.includes(newScore) && !unlockedAchievements.has(newScore)) {

                unlockedAchievements.add(newScore);

                showAchievement(newScore);

            }



            // 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞—á–∏–≤–∫–∏ (–£–î–ê–õ–ï–ù–û)

        }



        function clickCat(catNumber, x, y) {

            score++;

            document.getElementById('score').innerText = `–û—á–∫–∏ —É—é—Ç–∞: ${score}`;

            checkAchievement(score);

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç –≤ Supabase –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (–Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π –≤—ã–∑–æ–≤)
            const user = tg.initDataUnsafe?.user;
            if (user && supabaseClient) {
                // –í—ã–∑—ã–≤–∞–µ–º –±–µ–∑ await, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å UI
                updateScore(user.id, user.username || 'anon', score).catch(err => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å—á–µ—Ç–∞:', err);
                });
            }



            // –ü–æ–ª—É—á–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–ª–∏–∫–∞ (–¥–ª—è –∫–Ω–æ–ø–∫–∏ - —ç—Ç–æ —Å–∞–º–∞ –∫–Ω–æ–ø–∫–∞, –¥–ª—è –∫–æ—Ç–∞ - –µ–≥–æ —Ü–µ–Ω—Ç—Ä)

            let finalX, finalY;

            if (catNumber === 1 || catNumber === 2) {

                const cat = document.getElementById('cat' + catNumber);

                const rect = cat.getBoundingClientRect();

                finalX = rect.left + rect.width / 2;

                finalY = rect.top + rect.height / 2;

            } else {

                finalX = x;

                finalY = y;

            }



            // –°–æ–∑–¥–∞—ë–º —Å–µ—Ä–¥–µ—á–∫–æ

            createParticle(finalX, finalY, '‚ô•Ô∏è', '#ff69b4');



            // –ú–µ–Ω—è–µ–º —Ñ–æ—Ç–æ, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∞–ø–Ω—É–ª–∏ –ø–æ –∫–æ—Ç—É, –∞ –Ω–µ –ø–æ –±–æ–ª—å—à–æ–π –∫–Ω–æ–ø–∫–µ

            if (catNumber === 1) {

                cat1Index = (cat1Index + 1) % cat1Photos.length;

                document.getElementById('cat1').src = cat1Photos[cat1Index];

            } else if (catNumber === 2) {

                cat2Index = (cat2Index + 1) % cat2Photos.length;

                document.getElementById('cat2').src = cat2Photos[cat2Index];

            }



            // –ê–≤—Ç–æ—Å–µ–π–≤ —Å—á—ë—Ç–∞

            tg.GameProxy.setGameScore({ score: score }, (data) => {

                if (data) {

                    // Score saved

                }

            });

        }






        function openModal() {
            try {
                const modal = document.getElementById('welcomeModal');
                if (!modal) {
                    console.warn('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                    return;
                }
                modal.classList.add('show');
                modal.setAttribute('aria-hidden', 'false');
                document.body.classList.add('has-modal');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞:', error);
            }
        }



        function closeModal() {

            const modal = document.getElementById('welcomeModal');

            if (!modal) return;

            modal.classList.remove('show');

            modal.setAttribute('aria-hidden', 'true');

            document.body.classList.remove('has-modal');

        }

        

        // --- –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê –î–õ–Ø –ë–û–õ–¨–®–û–ô –ö–†–£–ì–õ–û–ô –ö–ù–û–ü–ö–ò ---



        function handleTapZone(e) {

            e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ



            let clientX;

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–¥–ª—è —Ç–∞—á–∞ –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –ø–∞–ª–µ—Ü, –¥–ª—è –∫–ª–∏–∫–∞ - mouseX)

            if (e.touches && e.touches.length > 0) {

                clientX = e.touches[0].clientX;

            } else if (e.clientX !== undefined) {

                clientX = e.clientX;

            } else {

                return; // –ï—Å–ª–∏ –Ω–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, –≤—ã—Ö–æ–¥–∏–º

            }



            const button = e.currentTarget;

            const rect = button.getBoundingClientRect();

            const center = rect.left + rect.width / 2;

            const tapX = clientX;

            const tapY = rect.top + rect.height / 2; // –¶–µ–Ω—Ç—Ä –∫–Ω–æ–ø–∫–∏ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏



            let catToClick;

            

            // –ï—Å–ª–∏ —Ç–∞–ø–Ω—É–ª–∏ –ø–æ –ª–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω–µ (–º–µ–Ω—å—à–µ —Ü–µ–Ω—Ç—Ä–∞)

            if (tapX < center) {

                catToClick = 1; // –®–æ–∫–æ–ª–∞–¥–Ω—ã–π –∫–æ—Ç–∏–∫

            } 

            // –ï—Å–ª–∏ —Ç–∞–ø–Ω—É–ª–∏ –ø–æ –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω–µ (–±–æ–ª—å—à–µ —Ü–µ–Ω—Ç—Ä–∞)

            else {

                catToClick = 2; // –°–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π –∫–æ—Ç–∏–∫

            }

            

            // –í—ã–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫–ª–∏–∫–∞, –ø–µ—Ä–µ–¥–∞–≤–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–∞–ø–∞

            clickCat(catToClick, tapX, tapY);

        }



        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

        window.onload = function() {
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
            setTimeout(() => {
                openModal();
            }, 100);



            const audio = document.getElementById('backgroundMusic');

            audio.volume = 0.3;

            audio.play().catch(e => console.log('–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∑–≤—É–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'));

            

            // 1. –ö–æ—Ç–∏–∫–∏: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ touchstart/click –≤ —Ü–µ–Ω—Ç—Ä–µ

            const cat1 = document.getElementById('cat1');

            const cat2 = document.getElementById('cat2');

            

            if (cat1 && cat2) {
                // –î–ª—è –∫–æ—Ç–∏–∫–æ–≤ –æ—Ç–∫–ª—é—á–∞–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥–≤–æ–π–Ω–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —Ç–∞–ø –ø–æ–ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –Ω–∞ –∫–æ—Ç–∞ –∏ –Ω–∞ –∑–æ–Ω—É —Ç–∞–ø–∞.

                // –¢–µ–ø–µ—Ä—å –æ—Å–Ω–æ–≤–Ω–∞—è –∑–æ–Ω–∞ –∫–ª–∏–∫–∞ - tapZone. –ö–æ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞

                cat1.addEventListener('touchstart', (e) => { 
                    e.preventDefault(); 
                    clickCat(1); 
                }, { passive: false });

                cat2.addEventListener('touchstart', (e) => { 
                    e.preventDefault(); 
                    clickCat(2); 
                }, { passive: false });

                cat1.addEventListener('click', () => clickCat(1));

                cat2.addEventListener('click', () => clickCat(2));
            } else {
                console.warn('–≠–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ç–∏–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
            }



            // 2. –ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–∞–ø—ã/–∫–ª–∏–∫–∏ –¥–ª—è —Å–º–µ–Ω—ã —Ñ–æ—Ç–æ

            const tapZone = document.getElementById('tapZone');

            if (tapZone) {
                tapZone.addEventListener('touchstart', handleTapZone, { passive: false });

                tapZone.addEventListener('click', handleTapZone);
            } else {
                console.warn('–≠–ª–µ–º–µ–Ω—Ç tapZone –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }

            // 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ñ–æ–Ω
            const leaderboardModal = document.getElementById('leaderboardModal');
            if (leaderboardModal) {
                leaderboardModal.addEventListener('click', (e) => {
                    if (e.target.id === 'leaderboardModal') {
                        leaderboardModal.classList.remove('show');
                        leaderboardModal.setAttribute('aria-hidden', 'true');
                        document.body.classList.remove('has-modal');
                    }
                });
            }

        };

    </script>

    <div id="footer" style="position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); font-size: 12px; color: #b0b0b0; white-space: nowrap; z-index: 1;">Kesha and Keks (v0.3) powerd by Jeremy Elfo (c) 2025</div>

</body>

</html>
